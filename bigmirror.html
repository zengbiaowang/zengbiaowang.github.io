<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style type="text/css">
		*{
			margin:0;
			padding:0;
		}
		#div1{
			width:400px;
			height:400px;
			margin:10px;
			position: relative;
		}
		#p1{
			width:100px;
			height:100px;
			background: #00f;
			position: absolute;
			left:0;
			top:0;
			opacity: 0.3;
			filter:alpha(opacity=30);
			display: none;
		}
		#img{
			width:400px;
			height:400px;
		}
		#div2{
			width:400px;
			height:400px;
			margin:10px;
			position: absolute;
			left:500px;
			top:0;
			display: none;
			overflow: hidden;
		}
		#img2{
			position: absolute;
			left:0;
			top:0;
		}
	</style>
	<script type="text/javascript">
	window.onload=function(){
		var oDiv=document.getElementById('div1');
		var oDiv2=document.getElementById('div2');
		var oP=document.getElementById('p1');
		var oImg2=document.getElementById('img2');
		oDiv.onmouseover=function(ev){
			var oEvent=ev || event;
			var from=oEvent.fromElement || oEvent.relatedTarget;
			if(oDiv.contains(from)){
				return;
			}
			oP.style.display='block';			
			oDiv2.style.display='block';			
		};
		oDiv.onmouseout=function(ev){
			var oEvent=ev || event;
			var to=oEvent.toElement || oEvent.relatedTarget;
			if(oDiv.contains(to)){
				return;
			}
			oP.style.display='none';
			oDiv2.style.display='none';
		};
		oDiv.onmousemove=function(ev){
			var oEvent=ev || event;
			var x=oEvent.clientX-oP.offsetWidth/2;
			var y=oEvent.clientY-oP.offsetHeight/2;
			if(x<=0){
				x=0;
			}
			if(x>=oDiv.offsetWidth-oP.offsetWidth+0){
				x=oDiv.offsetWidth-oP.offsetWidth+0;
			}
			if(y<=0){
				y=0;
			}
			if(y>=oDiv.offsetHeight-oP.offsetHeight+0){
				y=oDiv.offsetHeight-oP.offsetHeight+0;
			}
			oP.style.left=x+'px';
			oP.style.top=y+'px';
			var l=x/(oDiv.offsetWidth-oP.offsetWidth)*(oImg2.offsetWidth-oDiv2.offsetWidth);
			var t=y/(oDiv.offsetHeight-oP.offsetHeight)*(oImg2.offsetHeight-oDiv2.offsetHeight);
			oImg2.style.left=-l+'px';
			oImg2.style.top=-t+'px';
		};
	};
	</script>
</head>
<body>
	<div id="div1">
		<img src="1.jpg" alt="" id="img" />
		<p id="p1"></p>
	</div>
	<div id="div2">
		<img src="1.jpg" alt="" id="img2" />
	</div>
</body>
</html>